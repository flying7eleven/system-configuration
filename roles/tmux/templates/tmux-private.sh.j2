#!/usr/bin/env bash

SESSION="private"

# Check if session already exists
if tmux has-session -t "$SESSION" 2>/dev/null; then
    echo "Session '$SESSION' already exists. Attaching..."
    exec tmux attach-session -t "$SESSION"
fi

# Create the requested windows
tmux new-session -d -s "$SESSION" -n "home" -c "$HOME"
{% if ansible_facts["os_family"] == 'Darwin' %}
tmux new-window -t "$SESSION" -n "adelie" -c "$HOME/Private/dev/adelie"
tmux new-window -t "$SESSION" -n "adelie-specs" -c "$HOME/Private/dev/adelie-specs"
tmux new-window -t "$SESSION" -n "flyg-specs" -c "$HOME/Private/dev/flyg-specs"
tmux new-window -t "$SESSION" -n "flyg-plugin-xplane" -c "$HOME/Private/dev/flyg-specs/flyg-plugin-xplane"
tmux new-window -t "$SESSION" -n "comhartha" -c "$HOME/Private/dev/comhartha"
tmux new-window -t "$SESSION" -n "minne" -c "$HOME/Private/dev/minne"
tmux new-window -t "$SESSION" -n "nota" -c "$HOME/Private/dev/nota"
tmux new-window -t "$SESSION" -n "minchoigeartu" -c "$HOME/Private/dev/minchoigeartu"
tmux new-window -t "$SESSION" -n "system-configuration" -c "$HOME/Private/dev/system-configuration"
{% else %}
tmux new-window -t "$SESSION" -n "adelie" -c "$HOME/Development/adelie"
tmux new-window -t "$SESSION" -n "adelie-specs" -c "$HOME/Development/adelie-specs"
tmux new-window -t "$SESSION" -n "flyg-specs" -c "$HOME/Development/flyg-specs"
tmux new-window -t "$SESSION" -n "flyg-plugin-xplane" -c "$HOME/Development/flyg-specs/flyg-plugin-xplane"
tmux new-window -t "$SESSION" -n "comhartha" -c "$HOME/Development/comhartha"
tmux new-window -t "$SESSION" -n "minne" -c "$HOME/Development/minne"
tmux new-window -t "$SESSION" -n "nota" -c "$HOME/Development/nota"
tmux new-window -t "$SESSION" -n "minchoigeartu" -c "$HOME/Development/minchoigeartu"
tmux new-window -t "$SESSION" -n "system-configuration" -c "$HOME/Development/system-configuration"
{% endif %}

# Attach to session
tmux select-window -t "$SESSION:1"
exec tmux attach-session -t "$SESSION"
